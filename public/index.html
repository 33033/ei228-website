<!DOCTYPE html>




<html>
  <head>
	<meta name="generator" content="Hugo 0.32.4" />
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title> 工科创II-B第十四组</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Your name">
<meta name="description" content="Cool description">
<meta http-equiv="content-language" content="en-AU" />














<meta name="og:site_name" content="工科创II-B第十四组">
<meta name="og:title" content="工科创II-B第十四组">
<meta name="og:url" content="http://35.194.229.104/">
<meta name="twitter:title" content="工科创II-B第十四组" />
<meta name="twitter:url" content="http://35.194.229.104/" />
<meta name="twitter:card" content="" />




    

<link rel="stylesheet" href="css/animate.css">

<link rel="stylesheet" href="css/icomoon.css">

<link rel="stylesheet" href="css/simple-line-icons.css">

<link rel="stylesheet" href="css/magnific-popup.css">

<link rel="stylesheet" href="css/bootstrap.css">

<link rel="stylesheet" href="css/style.css">

<link rel="stylesheet" href="css/default.css">

  </head>
  <body>

    
    <div class="fh5co-loader"></div>
    <div class="fh5co-page">
      <div id="fh5co-container">
	
	<div id="fh5co-home" class="js-fullheight-home" data-section="home" style="background-image: url(http://35.194.229.104/images/hero_bg.jpg);" data-stellar-background-ratio="0.5">
  <div class="container">
    <div class="col-md-6">
      <div class="js-fullheight-home fh5co-copy">
	<div class="js-fullheight-home fh5co-copy-inner">
	  <h1>工科创II-B第十四组</h1>
	  <h2>小车走黑线</h2>
	</div>
      </div>
    </div>
  </div>
</div>

	
	<div class="js-sticky">
  <div class="fh5co-main-nav">
    <div class="container">
      <div class="fh5co-menu-1">

	<a href="#" data-nav-section="home">首页</a>

	
	<a href="#" data-nav-section="mission">项目介绍</a>
	

	
	<a href="#" data-nav-section="services">软件部分</a>
	

	
	<a href="#" data-nav-section="team">硬件部分</a>
	

	
	<a href="#" data-nav-section="contact">附录</a>
	
	
      </div>
    </div>
  </div>
</div>


	
	<div id="fh5co-about" data-section="mission">
  <div class="fh5co-2col">
    
    <div class="fh5co-2col-inner left">
      
      <div class="fh5co-tabs-container">
	<ul class="fh5co-tabs fh5co-three">
	  
	  <li class="active">
	    <a href="#" data-tab=intro>项目介绍</a>
	  </li>
	  
	  <li>
	    <a href="#" data-tab=struct>结构说明</a>
	  </li>
	  
	  <li>
	    <a href="#" data-tab=result>完成情况</a>
	  </li>
	  
	</ul>

	
	
	<div class="fh5co-tab-content active" data-tab-content=intro>
	
	  <h2>项目整体介绍</h2>
	  <ul><li>本次课程项目的要求是利用计算机自动发布指令控制小车走黑线。</li><li>我们使用的软件操作平台为Xcode和opencv，用于分析地图并得出抽象路线、实时监控小车位置、根据小车位置发送指令。</li><li>硬件部分为蓝牙、MSP430单片机与老师提供的小车，用于接收指令并按照指令前行。</li></ul>

	</div>
	
	
	<div class="fh5co-tab-content" data-tab-content=struct>
	
	  <h2>整体结构说明</h2>
	  <ul><li>用计算机自带摄像头拍摄地图，分析并得出路径与拐点</li><li>计算机通过摄像头监控小车位置，得出小车前往下一个拐点的方向，并发送指令</li><li>小车通过蓝牙接收指令，由单片机转化为对小车的控制，让小车运行</li></ul>

	</div>
	
	
	<div class="fh5co-tab-content" data-tab-content=result>
	
	  <h2>整体完成情况</h2>
	  <ul class='checked'><li>计算机可抽象出跑道，实时采集小车图像并发送指令</li><li>小车可自由前后左右运动，可通过蓝牙接收计算机指令，按黑线前进</li><li>小车整体运动流畅，速度适中，转弯灵活，并在重点的自动停止</li></ul>

	</div>
	


      </div>
      
    </div>
    
  </div>
  
  <div class="fh5co-2col fh5co-text">
    <div class="fh5co-grid">
      
      
      <div class="fh5co-grid-item" style="background-image: url(http://35.194.229.104/images/photo.jpg);"></div>
      
      <div class="fh5co-grid-item" style="background-image: url(http://35.194.229.104/images/hero_bg_orange.jpg);"></div>
      
      <div class="fh5co-grid-item" style="background-image: url(http://35.194.229.104/images/hero_bg_blue.jpg);"></div>
      
      <div class="fh5co-grid-item" style="background-image: url(http://35.194.229.104/images/working.jpg);"></div>
      
      
      
    </div>
  </div>
</div> 

	
	
	
	<div id="fh5co-services" data-section="services">
  
  
  <div class="fh5co-video"><a href="video.mp4" class="popup-vimeo"><i class="icon-play2"></i></a> <span>Watch video</span></div>
  
  <div class="container">
    <div class="col-md-6 col-md-offset-3 text-center fh5co-heading">
      <h2>软件部分</h2>
      <p>运行环境：MAC OS系统 Xcode+OpenCV</p>
    </div>
    
    
    <div class="col-md-4">
      <div class="service">
	<div class="icon"><i class=icon-feed></i></div>
	<h3>蓝牙串口通信</h3>
	<p>参考2015-12B02小组的蓝牙串口代码，经过针对本组小车和计算机进行的细节改动，包装成go(), stop(), turnleft(), turnright()函数，将指令传输给小车。</p>
      </div>
    </div>
    
    <div class="col-md-4">
      <div class="service">
	<div class="icon"><i class=icon-eye></i></div>
	<h3>图像获取</h3>
	<p>使用计算机内置摄像头，调用cvCreateCameraCapture()获取图像，绘制窗口的部分包装成image.h 和image.cpp</p>
      </div>
    </div>
    
    <div class="col-md-4">
      <div class="service">
	<div class="icon"><i class=icon-layers></i></div>
	<h3>图像处理：透视变换</h3>
	<p>手动选择窗口图像的四个角，主要调用了cvGetPerspectiveTransform()和cvWarpPerspective()， 对图像进行透视变换， 具体实现在perspectiveTransform.h perspectiveTransform.cpp</p>
      </div>
    </div>
    
    <div class="col-md-4">
      <div class="service">
	<div class="icon"><i class=icon-frame></i></div>
	<h3>图像处理：二值化</h3>
	<p>利用opencv内置cvThreshold()，将数值小于设定阈值的点设置成0，其余设置为255，使透视变换后的图像变为黑白两种颜色，具体实现在binarization.h binarization.cpp</p>
      </div>
    </div>
    
    <div class="col-md-4">
      <div class="service">
	<div class="icon"><i class=icon-target></i></div>
	<h3>图像处理：细化</h3>
	<p>通过迭代的方式，每次迭代将图像减少一最外层的一个像素点，并保持连通性，对二值化后的图像进行细化，再对细化结果进行判断，将距离较近的直线合并成一条直线（去掉误差产生的多余直线），具体实现在hough.h hough.cpp</p>
      </div>
    </div>
    
    <div class="col-md-4">
      <div class="service">
	<div class="icon"><i class=icon-cursor></i></div>
	<h3>小车追踪与控制</h3>
	<p>车头车尾分别用橙色和绿色两个色块，用camsift算法找到它们的位置，车头车尾的连线为小车矢量，路径转折点间的连线为路径矢量，通过这两个矢量的夹角，计算给小车下达的指令，通过tracking.h tracking.cpp 和controlling.h controlling.cpp实现</p>
      </div>
    </div>
    
    
    
  </div>
  
</div> 

	
	
	
	<div id="fh5co-gallery">
  
  <a href="http://35.194.229.104/images/%E9%80%8F%E8%A7%86%E5%8F%98%E6%8D%A2.jpeg" class="fh5co-item image-popup" style="background-image: url(http://35.194.229.104/images/%E9%80%8F%E8%A7%86%E5%8F%98%E6%8D%A2.jpeg)">
    <div class="fh5co-overlay"></div>
    <div class="fh5co-copy">
      <div class="fh5co-copy-inner">
	<h2>透视变换</h2>
	
      </div>
    </div>
  </a>
  
  <a href="http://35.194.229.104/images/%E4%BA%8C%E5%80%BC%E5%8C%96.jpeg" class="fh5co-item image-popup" style="background-image: url(http://35.194.229.104/images/%E4%BA%8C%E5%80%BC%E5%8C%96.jpeg)">
    <div class="fh5co-overlay"></div>
    <div class="fh5co-copy">
      <div class="fh5co-copy-inner">
	<h2>二值化</h2>
	
      </div>
    </div>
  </a>
  
  <a href="http://35.194.229.104/images/%E7%BB%86%E5%8C%96%E5%A4%84%E7%90%86.jpeg" class="fh5co-item image-popup" style="background-image: url(http://35.194.229.104/images/%E7%BB%86%E5%8C%96%E5%A4%84%E7%90%86.jpeg)">
    <div class="fh5co-overlay"></div>
    <div class="fh5co-copy">
      <div class="fh5co-copy-inner">
	<h2>细化处理</h2>
	
      </div>
    </div>
  </a>
  
  <a href="http://35.194.229.104/images/%E7%A1%AE%E5%AE%9A%E8%B7%AF%E5%BE%84.jpeg" class="fh5co-item image-popup" style="background-image: url(http://35.194.229.104/images/%E7%A1%AE%E5%AE%9A%E8%B7%AF%E5%BE%84.jpeg)">
    <div class="fh5co-overlay"></div>
    <div class="fh5co-copy">
      <div class="fh5co-copy-inner">
	<h2>确定路径</h2>
	
      </div>
    </div>
  </a>
  
  <a href="http://35.194.229.104/images/%E5%AE%9A%E4%BD%8D%E5%B0%8F%E8%BD%A6.jpeg" class="fh5co-item image-popup" style="background-image: url(http://35.194.229.104/images/%E5%AE%9A%E4%BD%8D%E5%B0%8F%E8%BD%A6.jpeg)">
    <div class="fh5co-overlay"></div>
    <div class="fh5co-copy">
      <div class="fh5co-copy-inner">
	<h2>定位小车</h2>
	
      </div>
    </div>
  </a>
  
</div> 

	
	
	
	<div id="fh5co-team" data-section="team">
  <div class="container">
    
    <div class="col-md-6 col-md-offset-3 text-center fh5co-heading">
      <h2>硬件部分</h2>
      <p>完整代码请<a href="#" data-toggle="modal" data-target="#myModal">点击这里</a></p>
    </div>
   
    
    
    <div class="col-md-4">
      <div class="person">
	<img src="http://35.194.229.104/images/photo.jpg" alt="" class="img-responsive">
	<h3>小车整体设计</h3>
	<h4></h4>
	<p>小车的单片机为MSP430单片机，通过Energia软件编程。</p>
	<ul class="social">
	  
	  
	  
	  
	  
	  
	</ul>
      </div>
    </div>
    
    <div class="col-md-4">
      <div class="person">
	<h3>Serial.begin()</h3>
	<h4></h4>
	<p>打开串口，设置数据传输速率</p>
	<ul class="social">
	  
	  
	  
	  
	  
	  
	</ul>
      </div>
    </div>
    
    <div class="col-md-4">
      <div class="person">
	<h3>Serial.available()</h3>
	<h4></h4>
	<p>判断是否是否接收到消息</p>
	<ul class="social">
	  
	  
	  
	  
	  
	  
	</ul>
      </div>
    </div>
    
    <div class="col-md-4">
      <div class="person">
	<h3>Serial.read()</h3>
	<h4></h4>
	<p>从串口接收信息并返回</p>
	<ul class="social">
	  
	  
	  
	  
	  
	  
	</ul>
      </div>
    </div>
    
    <div class="col-md-4">
      <div class="person">
	<h3>forward(), turnleft(), turnright(), _stop()</h3>
	<h4></h4>
	<p>向引脚输出信号，分别控制小车前进、左转、右转、停止</p>
	<ul class="social">
	  
	  
	  
	  
	  
	  
	</ul>
      </div>
    </div>
    
    
  </div>
</div> 

	

	
	<div id="fh5co-contact" data-section="contact">
  <div class="container">
    <div class="col-md-6 col-md-offset-3 text-center fh5co-heading">
      
      <h2>附录</h2>
      <p><p><a href="downloads/sketch_nov25a.ino">硬件部分代码</a></p><p><a href="downloads/PC端代码.zip">软件部分代码</a></p><p>参考资料</p>
</p>
      
    </div>
  </div>
</div>

	
	
	
	<div id="fh5co-footer">
  <div class="container">
    <div class="row">
      
      <div class="col-md-6">
	<small>&copy; 2016 Free HTML5 Template. All Rights Reserved. <br> Designed by <a href='http://freehtml5.co/' target='_blank'>FreeHTML5.co</a> Demo Images: <a href='http://pexels.com/' target='_blank'>Pexels</a><br>Hugo port by <a href='https://github.com/SteveLane/' target='_blank'>SteveLane</a></small>
      </div>
      <div class="col-md-6">
	<ul class="fh5co-social">
	  
	  <li><a href="#"><i class="icon-github"></i></a></li>
	  
	  
	  
	  
	  
	  
	</ul>
      </div>
      
    </div>
  </div>
</div>

	
      
      </div>
    </div>
    
    <div class="gototop js-top">
  <a href="#" class="js-gotop"><i class="icon-arrow-up"></i></a>
</div>

<script src="js/highlight.pack.js"></script>

<script src="js/jquery.min.js"></script>

<script src="js/jquery.easing.1.3.js"></script>

<script src="js/bootstrap.min.js"></script>

<script src="js/jquery.waypoints.min.js"></script>

<script src="js/jquery.stellar.min.js"></script>

<script src="js/jquery.magnific-popup.min.js"></script>
<script src="js/magnific-popup-options.js"></script>

<script src="js/main.js"></script>

    
  </body>

  <!-- Modal -->
      <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
	            <div class="modal-dialog modal-lg" role="document">
			            <div class="modal-content">
					              <div class="modal-header">
							                  <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
									  <h4 class="modal-title" id="myModalLabel">硬件部分代码</h4>
										                </div>
												          <div class="modal-body">
														              <pre>
            <code class="C++">

#define IN1 10
#define IN2 9     //定义IN1接10引脚，控制左轮前进；IN2接9引脚，控制左轮后退
#define IN3 12 
#define IN4 13     //定义IN3接12引脚，控制右轮前进；IN4接13引脚，控制右轮后退
#define STEER 14

#include &lt;Servo.h&gt;
Servo servo_pin_14;

void forward( );
void back( );
void turnLeft( );
void turnRight( );
void turnbackLeft( );
void turnbackRight( );
void turnLeftOrigin( );
void turnRightOrigin( );
void _stop();          //声明要用到的函数

int TURN = 120;
int TURNZUO = 100;
int RUN1 = 100;//左轮前进
int RUN2 = 80;//右轮前进

void setup()
{
  pinMode(IN1,OUTPUT);
  pinMode(IN2,OUTPUT);
  pinMode(IN3,OUTPUT);
  pinMode(IN4,OUTPUT);
  Serial.begin(9600);// 打开串口，并将数据传输速率设置为9600bps
}
//循环接受蓝牙信号，根据信号
int i;
void loop()
{
    if(Serial.available())// 判断是否收到消息，有则返回值为1，否则为0
    {
      i=Serial.read(); //从串口中读取信息，并作为返回值返回。
      
      switch(i) //根据接收到的信息运行不同函数
      {
        case'1':
          {turnLeft( );  break; }
        case'2':
          {forward( );   break;}
        case'3':
          {turnRight( );   break;}
        case'4':
          {turnLeftOrigin( );   break;}
        case'5':
          {_stop();   break;}
        case'6':
          {turnRightOrigin( );   break;}
        case'7':
          {turnbackLeft( );   break;}
        case'8':
          {back( );   break;}
        case'9':
          {turnbackRight( );   break;}
      }
    }    
}

//forward函数功能：控制车前进

void forward( )
{
  analogWrite(IN1,RUN2);      
  digitalWrite(IN2,LOW);         //左轮前进
  analogWrite(IN3,RUN1);      
  digitalWrite(IN4,LOW);         //右轮前进
}

//back函数功能：控制车后退

void back( )
{
  digitalWrite(IN1,LOW);      
  analogWrite(IN2,RUN1);        //左轮后退
  digitalWrite(IN3,LOW);      
  analogWrite(IN4,RUN1);        //右轮后退
}

// turnLeft函数功能：控制车左转

void turnLeft( )
{
  digitalWrite(IN1,LOW);      
  digitalWrite(IN2,LOW);         //左轮静止不动
  analogWrite(IN3,TURNZUO);      
  digitalWrite(IN4,LOW);         //右轮前进
}

// turnbackLeft函数功能：控制车左后转弯

void turnbackLeft( )
{
  digitalWrite(IN1,LOW);      
  digitalWrite(IN2,LOW);         //左轮静止不动
  digitalWrite(IN3,LOW);      
  analogWrite(IN4,TURN);         //右轮后退
}

//turnRight函数功能：控制车右后转弯

void turnRight( )
{
  analogWrite(IN1,TURNZUO);      
  digitalWrite(IN2,LOW);         //左轮前进
  digitalWrite(IN3,LOW);      
  digitalWrite(IN4,LOW);         //右轮静止不动
}

// turnbackRight：函数功能：控制车右转

void turnbackRight( )
{
  digitalWrite(IN1,LOW);      
  analogWrite(IN2,TURNZUO);         //左轮后退
  digitalWrite(IN3,LOW);      
  digitalWrite(IN4,LOW);         //右轮静止不动
}

// turnLeftOrigin函数功能：控制车原地左转

void turnLeftOrigin( )
{
  digitalWrite(IN1,LOW);      
  analogWrite(IN2,TURN);        //左轮后退
  analogWrite(IN3,TURN);      
  digitalWrite(IN4,LOW);         //右轮前进
}

// turnRightOrigin函数功能：控制车原地右转

void turnRightOrigin( )
{
  analogWrite(IN1,TURN);      
  digitalWrite(IN2,LOW);        //左轮前进
  digitalWrite(IN3,LOW);      
  analogWrite(IN4,TURN);       //右轮后退
}

// stop函数功能：控制车停止

void _stop()
{
  digitalWrite(IN1,LOW);      
  digitalWrite(IN2,LOW);         //左轮静止不动
  digitalWrite(IN3,LOW);      
  digitalWrite(IN4,LOW);         //右轮静止不动
}

</code>
            </pre>

	              </div>
		              </div>
			            </div>
				        </div>

</html>
